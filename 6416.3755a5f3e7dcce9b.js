"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6416],{6416:(W,b,a)=>{a.r(b),a.d(b,{ScanTabModule:()=>X,createTranslateLoader:()=>S});var o=a(8043),g=a(6895),h=a(4006),A=a(529),_=a(4032),C=a(9832),v=a(4228),d=a(5861),l=(()=>{return(t=l||(l={}))[t.Default=0]="Default",t[t.Name=1]="Name",t[t.Address=2]="Address",t[t.RSSI=3]="RSSI",l;var t})(),p=a(4870),e=a(8274);function w(t,s){if(1&t&&(e.TgZ(0,"ion-item")(1,"ion-label"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._UZ(4,"ion-radio",4),e.qZA()),2&t){const n=s.$implicit;e.xp6(2),e.Oqu(e.lcZ(3,2,"SelectModule.modules."+n)),e.xp6(2),e.s9C("value",n)}}let M=(()=>{class t{constructor(n){this.modalCtrl=n,this.selectedmodule=p.Q[p.Q.ProteusIII],this.modules=Object.keys(p.Q).map(i=>p.Q[i]).filter(i=>"string"==typeof i)}ngOnInit(){}choosemodule(){return this.modalCtrl.dismiss(p.Q[this.selectedmodule],"confirm")}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(o.IN))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-select-module"]],decls:10,vars:8,consts:[[1,"inner-content"],[3,"ngModel","ngModelChange"],[4,"ngFor","ngForOf"],[2,"width","100%",3,"click"],[3,"value"]],template:function(n,i){1&n&&(e.TgZ(0,"div",0)(1,"h1"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"ion-list")(5,"ion-radio-group",1),e.NdJ("ngModelChange",function(r){return i.selectedmodule=r}),e.YNc(6,w,5,4,"ion-item",2),e.qZA()(),e.TgZ(7,"ion-button",3),e.NdJ("click",function(){return i.choosemodule()}),e._uU(8),e.ALo(9,"translate"),e.qZA()()),2&n&&(e.xp6(2),e.Oqu(e.lcZ(3,4,"SelectModule.selectmodule")),e.xp6(3),e.Q6J("ngModel",i.selectedmodule),e.xp6(1),e.Q6J("ngForOf",i.modules),e.xp6(2),e.Oqu(e.lcZ(9,6,"SelectModule.select")))},dependencies:[o.YG,o.Ie,o.Q$,o.q_,o.B7,o.se,o.U5,o.QI,g.sg,h.JJ,h.On,_.X$]}),t})();var f=a(344),u=a(740),m=a(6519),N=a(1275);class Z extends N.j{constructor(s){super(s),this.gpioPins=new Map([[1,new m.m(1,"Test Pin 1",!1)],[2,new m.m(2,"Test Pin 2",!0)],[3,new m.m(3,"Test Pin 3",!0)],[4,new m.m(4,"Test Pin 4",!0)]]),this.resetTempGPIOPins(Array.from(this.gpioPins.values())),this.logInfo("Test Device Started"),this.logInfo("Info Message Test"),this.logGPIO("GPIO Message Test"),this.logDataSent("Data Sent Message Test"),this.logDataReceived("Data Received Message Test"),this.logDataReceived("Long Data Received Message Test",void 0,Uint8Array.from([115,109,109,119,111,118,122,118,105,104,98,106,114,107,121,122,108,115,105,118,121,120,105,109,107,101,107,102,100,113,112,116,110,114,119,109,118,113,107,108,112,101,98,104,98,112,109,105,101,116,122,99,116,119,115,111,116,116,99,100,113,120,119,118,107,119,111,103,113,98,110,109,99,108,115,115,114,109,102,120,102,111,100,113,110,99,100,117,104,98,99,103,108,97,121,100,112,119,108,114,103,97,117,97,115,109,109,119,111,118,122,118,105,104,98,106,114,107,121,122,108,115,105,118,121,120,105,109,107,101,107,102,100,113,112,116,110,114,119,109,118,113,107,108,112,101,98,104,98,112,109,105,101,116,122,99,116,119,115,111,116,116,99,100,113,120,119,118,107,119,111,103,113,98,110,109,99,108,115,115,114,109,102,120,102,111,100,113,110,99,100,117,104,98,99,103,108,97,121,100,112,119,108,114,103,97,117,97]).buffer)}formatreadpinconfiguration(){throw this.gpioPins.get(1).setPinType(0),this.gpioPins.get(2).setPinType(1),this.gpioPins.get(3).setPinType(2),this.gpioPins.get(4).setPinType(3),this.resetTempGPIOPins(Array.from(this.tempgpioPins.values())),new Error("Method not implemented.")}formatwritepinconfiguration(s){throw new Error("Method not implemented.")}formatreadpinvalues(s){throw new Error("Method not implemented.")}formatwritepinvalues(s){throw new Error("Method not implemented.")}getType(){}}var O=a(1526);const J=["scanselect"];function Q(t,s){1&t&&(e.TgZ(0,"div"),e._UZ(1,"ion-spinner",17),e.qZA())}function q(t,s){1&t&&(e.TgZ(0,"ion-select-option",18),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"ScanTab.scansorttype.rssi")))}function P(t,s){if(1&t){const n=e.EpF();e.TgZ(0,"div")(1,"ion-button",19),e.NdJ("click",function(){e.CHM(n);const c=e.oxw();return e.KtG(c.clearscan())}),e._uU(2),e.ALo(3,"translate"),e.qZA()()}2&t&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"ScanTab.clearfounddevices")))}function D(t,s){1&t&&e._UZ(0,"ion-icon",29)}function Y(t,s){1&t&&e._UZ(0,"ion-icon",30)}function U(t,s){1&t&&e._UZ(0,"ion-icon",31)}function k(t,s){1&t&&e._UZ(0,"ion-icon",32)}function L(t,s){if(1&t&&(e.TgZ(0,"ion-label",23),e.YNc(1,D,1,0,"ion-icon",24),e.YNc(2,Y,1,0,"ion-icon",25),e.YNc(3,U,1,0,"ion-icon",26),e.YNc(4,k,1,0,"ion-icon",27),e.TgZ(5,"ion-label",28),e._uU(6),e.qZA()()),2&t){const n=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf",n.rssi>-60),e.xp6(1),e.Q6J("ngIf",n.rssi>-70&&n.rssi<=-60),e.xp6(1),e.Q6J("ngIf",n.rssi>-80&&n.rssi<=-70),e.xp6(1),e.Q6J("ngIf",n.rssi<=-80),e.xp6(2),e.Oqu(n.rssi)}}function F(t,s){1&t&&(e.TgZ(0,"ion-label",23),e._UZ(1,"ion-icon",33),e.qZA())}function R(t,s){if(1&t){const n=e.EpF();e.TgZ(0,"ion-item",6),e.NdJ("click",function(){const r=e.CHM(n).$implicit,x=e.oxw(3);return e.KtG(x.scanitemclick(r))}),e.TgZ(1,"ion-label")(2,"ion-label",5),e._uU(3),e.qZA(),e.TgZ(4,"ion-label",21),e._uU(5),e.qZA()(),e.YNc(6,L,7,5,"ion-label",22),e.YNc(7,F,2,0,"ion-label",22),e.qZA()}if(2&t){const n=s.$implicit,i=e.oxw(3);e.xp6(3),e.Oqu(n.localName||"-"),e.xp6(2),e.Oqu(n.device.deviceId),e.xp6(1),e.Q6J("ngIf",!i.ble.connectedDevices.has(n.device.deviceId)),e.xp6(1),e.Q6J("ngIf",i.ble.connectedDevices.has(n.device.deviceId))}}function G(t,s){if(1&t&&(e.TgZ(0,"ion-list"),e.YNc(1,R,8,4,"ion-item",20),e.qZA()),2&t){const n=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",n.scanresults)}}function z(t,s){if(1&t&&(e.ynx(0),e.YNc(1,G,2,1,"ion-list",8),e.BQk()),2&t){const n=e.oxw();e.xp6(1),e.Q6J("ngIf",0!=n.scanresults.length)}}function E(t,s){1&t&&(e.TgZ(0,"ion-label",23),e._UZ(1,"ion-icon",33),e.qZA())}function B(t,s){if(1&t){const n=e.EpF();e.TgZ(0,"ion-item",6),e.NdJ("click",function(){const r=e.CHM(n).$implicit,x=e.oxw(3);return e.KtG(x.paireddeviceclick(r))}),e.TgZ(1,"ion-label")(2,"ion-label",5),e._uU(3),e.qZA(),e.TgZ(4,"ion-label",21),e._uU(5),e.qZA()(),e.YNc(6,E,2,0,"ion-label",22),e.qZA()}if(2&t){const n=s.$implicit,i=e.oxw(3);e.xp6(3),e.Oqu(n.name||"-"),e.xp6(2),e.Oqu(n.deviceId),e.xp6(1),e.Q6J("ngIf",i.ble.connectedDevices.has(n.deviceId))}}function $(t,s){if(1&t&&(e.TgZ(0,"ion-list"),e.YNc(1,B,7,3,"ion-item",20),e.qZA()),2&t){const n=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",n.paireddevices)}}function j(t,s){if(1&t&&(e.ynx(0),e.YNc(1,$,2,1,"ion-list",8),e.BQk()),2&t){const n=e.oxw();e.xp6(1),e.Q6J("ngIf",0!=n.paireddevices.length)}}const H=[{path:"",component:(()=>{class t{constructor(n,i,c,r,x,I,T){this.ble=n,this.ngZone=i,this.router=c,this.platform=r,this.translateService=x,this.modalCtrl=I,this.toastController=T,this.scanning=!1,this.scantext="startscantext",this.scanresults=[],this.paireddevices=[],this.scanSortType=l[l.Default],this.connecting=!1,this.connectingdeviceid=void 0}ngOnInit(){var n=this;return(0,d.Z)(function*(){n.translateService.onLangChange.subscribe(()=>{n.translateService.get("ScanTab.scansorttype."+n.scanSortType.toLowerCase()).subscribe(function(){var i=(0,d.Z)(function*(c){n.select.selectedText=c});return function(c){return i.apply(this,arguments)}}())}),f.N.production||(n.platform.is("desktop")?n.paireddevices.push(u.y):n.scanresults.push(u.m))})()}ionViewDidEnter(){this.scanning=!1,this.scantext="startscantext"}ionViewDidLeave(){var n=this;return(0,d.Z)(function*(){n.platform.is("desktop")||n.stopscan()})()}scanclick(){this.scanning?this.stopscan():this.scan()}clearscan(){this.paireddevices=[],f.N.production||this.paireddevices.push(u.y)}scan(){var n=this;return(0,d.Z)(function*(){n.scanning=!0,n.scantext="stopscantext",n.scanresults=[],f.N.production||n.scanresults.push(u.m),n.platform.is("desktop")?n.ble.requestdevice(i=>{null!=i&&0==n.paireddevices.filter(c=>c.deviceId==i.deviceId).length&&(n.paireddevices.push(i),n.sort()),n.stopscan()}):n.ble.startscan(i=>{n.ngZone.run(()=>{n.scanresults.push(i),n.sort()})})})()}stopscan(){var n=this;return(0,d.Z)(function*(){n.scanning=!1,n.scantext="startscantext",n.platform.is("desktop")||(yield n.ble.stopscan())})()}scanitemclick(n){var i=this;return(0,d.Z)(function*(){f.N.production||n.device!=u.y||i.ble.connectedDevices.has(n.device.deviceId)?i.connect(n.device):i.ble.connectedDevices.set(n.device.deviceId,new Z(n.device))})()}paireddeviceclick(n){var i=this;return(0,d.Z)(function*(){f.N.production||n!=u.y||i.ble.connectedDevices.has(n.deviceId)?i.connect(n):i.ble.connectedDevices.set(n.deviceId,new Z(n))})()}refresh(n){var i=this;return(0,d.Z)(function*(){n.target.complete(),setTimeout((0,d.Z)(function*(){yield i.scan()}),250)})()}sortTypeChanged(n){var i=this;return(0,d.Z)(function*(){i.select.selectedText=void 0,i.scanSortType=n.detail.value,i.sort()})()}sort(){if(this.platform.is("desktop"))switch(l[this.scanSortType]){case l.Name:return void this.paireddevices.sort((n,i)=>n.name.localeCompare(i.name));case l.Address:return void this.paireddevices.sort((n,i)=>n.deviceId.localeCompare(i.deviceId));default:return}else switch(l[this.scanSortType]){case l.Name:return void this.scanresults.sort((n,i)=>n.localName.localeCompare(i.localName));case l.Address:return void this.scanresults.sort((n,i)=>n.device.deviceId.localeCompare(i.device.deviceId));case l.RSSI:return void this.scanresults.sort((n,i)=>n.rssi>i.rssi?-1:1);default:return}}loadingdismiss(){this.ble.connectedDevices.has(this.connectingdeviceid)&&this.router.navigate(["/tabs/terminal"],{queryParams:{deviceid:this.connectingdeviceid}}),this.connectingdeviceid=void 0}connect(n){var i=this;return(0,d.Z)(function*(){if(i.ble.connectedDevices.has(n.deviceId))i.router.navigate(["/tabs/terminal"],{queryParams:{deviceid:n.deviceId}});else{const c=yield i.modalCtrl.create({component:M});c.cssClass="auto-height",c.animated=!1,c.present();const{data:r,role:x}=yield c.onWillDismiss();if("confirm"===x){i.connectingdeviceid=n.deviceId,i.connecting=!0;try{yield i.ble.connect(n,r),i.connecting=!1}catch{i.connectingdeviceid=void 0,i.connecting=!1,i.translateService.get("ScanTab.connectionfailed").subscribe(function(){var T=(0,d.Z)(function*(y){(yield i.toastController.create({message:y,duration:500,position:"middle",cssClass:"toastwidth"})).present()});return function(y){return T.apply(this,arguments)}}())}}}})()}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(O.xH),e.Y36(e.R0b),e.Y36(v.F0),e.Y36(o.t4),e.Y36(_.sK),e.Y36(o.IN),e.Y36(o.yF))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-scantab"]],viewQuery:function(n,i){if(1&n&&e.Gf(J,5),2&n){let c;e.iGM(c=e.CRH())&&(i.select=c.first)}},decls:38,vars:30,consts:[[3,"translucent"],["color","primary"],["slot","fixed",3,"disabled","ionRefresh"],[1,"scanheader"],[1,"ion-text-center","ion-align-items-center","scanheaderrow"],[2,"font-weight","bold"],[3,"click"],["fill","clear"],[4,"ngIf"],[1,"ion-text-center","ion-align-items-center"],["interface","popover",1,"scansort",3,"value","ionChange"],["scanselect",""],["value","Default"],["value","Name"],["value","Address"],["value","RSSI",4,"ngIf"],["spinner","crescent",3,"isOpen","message","willDismiss"],["name","crescent","color","primary",1,"block"],["value","RSSI"],["fill","clear",3,"click"],[3,"click",4,"ngFor","ngForOf"],["color","medium",1,"deviceid"],["class","itemwrapnogrow ion-text-end",4,"ngIf"],[1,"itemwrapnogrow","ion-text-end"],["class","barsredcolor","size","small","src","assets/ic_signal/ic_signal_full.svg",4,"ngIf"],["class","barsredcolor","size","small","src","assets/ic_signal/ic_signal_3.svg",4,"ngIf"],["class","barsredcolor","size","small","src","assets/ic_signal/ic_signal_2.svg",4,"ngIf"],["class","barsredcolor","size","small","src","assets/ic_signal/ic_signal_1.svg",4,"ngIf"],["color","medium"],["size","small","src","assets/ic_signal/ic_signal_full.svg",1,"barsredcolor"],["size","small","src","assets/ic_signal/ic_signal_3.svg",1,"barsredcolor"],["size","small","src","assets/ic_signal/ic_signal_2.svg",1,"barsredcolor"],["size","small","src","assets/ic_signal/ic_signal_1.svg",1,"barsredcolor"],["size","small","color","primary","name","checkmark-outline"]],template:function(n,i){1&n&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-title"),e._uU(3),e.ALo(4,"translate"),e.qZA()()(),e.TgZ(5,"ion-content")(6,"ion-refresher",2),e.NdJ("ionRefresh",function(r){return i.refresh(r)}),e._UZ(7,"ion-refresher-content"),e.qZA(),e.TgZ(8,"ion-grid",3)(9,"ion-row",4)(10,"ion-col",5),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"ion-col",6),e.NdJ("click",function(){return i.scanclick()}),e.TgZ(14,"ion-button",7),e._uU(15),e.ALo(16,"translate"),e.qZA(),e.YNc(17,Q,2,0,"div",8),e.qZA()(),e.TgZ(18,"ion-row",9)(19,"ion-col")(20,"ion-select",10,11),e.NdJ("ionChange",function(r){return i.sortTypeChanged(r)}),e.TgZ(22,"ion-select-option",12),e._uU(23),e.ALo(24,"translate"),e.qZA(),e.TgZ(25,"ion-select-option",13),e._uU(26),e.ALo(27,"translate"),e.qZA(),e.TgZ(28,"ion-select-option",14),e._uU(29),e.ALo(30,"translate"),e.qZA(),e.YNc(31,q,3,3,"ion-select-option",15),e.qZA()(),e.TgZ(32,"ion-col"),e.YNc(33,P,4,3,"div",8),e.qZA()()(),e.YNc(34,z,2,1,"ng-container",8),e.YNc(35,j,2,1,"ng-container",8),e.qZA(),e.TgZ(36,"ion-loading",16),e.NdJ("willDismiss",function(){return i.loadingdismiss()}),e.ALo(37,"translate"),e.qZA()),2&n&&(e.Q6J("translucent",!1),e.xp6(3),e.hij(" ",e.lcZ(4,16,"ScanTab.tabname")," "),e.xp6(3),e.Q6J("disabled",1==i.scanning),e.xp6(5),e.hij(" ",e.lcZ(12,18,"ScanTab.founddevices")," "),e.xp6(4),e.Oqu(e.lcZ(16,20,"ScanTab."+i.scantext)),e.xp6(2),e.Q6J("ngIf",i.scanning),e.xp6(3),e.s9C("value",i.scanSortType),e.xp6(3),e.Oqu(e.lcZ(24,22,"ScanTab.scansorttype.default")),e.xp6(3),e.Oqu(e.lcZ(27,24,"ScanTab.scansorttype.name")),e.xp6(3),e.Oqu(e.lcZ(30,26,"ScanTab.scansorttype.address")),e.xp6(2),e.Q6J("ngIf",1!=i.platform.is("desktop")),e.xp6(2),e.Q6J("ngIf",0!=i.paireddevices.length),e.xp6(1),e.Q6J("ngIf",0==i.platform.is("desktop")),e.xp6(1),e.Q6J("ngIf",1==i.platform.is("desktop")),e.xp6(1),e.s9C("message",e.lcZ(37,28,"ScanTab.connecting")),e.Q6J("isOpen",i.connecting))},dependencies:[o.YG,o.wI,o.W2,o.jY,o.Gu,o.gu,o.Ie,o.Q$,o.q_,o.wh,o.nJ,o.Wo,o.Nd,o.t9,o.n0,o.PQ,o.wd,o.sr,o.QI,g.sg,g.O5,_.X$],styles:[".scanheaderrow[_ngcontent-%COMP%]{height:100px}.scansort[_ngcontent-%COMP%]{width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;margin:auto}.ios[_ngcontent-%COMP%]   .deviceid[_ngcontent-%COMP%]{font-size:small}.barsredcolor[_ngcontent-%COMP%]{filter:invert(12%) sepia(84%) saturate(7193%) hue-rotate(353deg) brightness(86%) contrast(110%)}"]}),t})()}];let K=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[v.Bz.forChild(H),v.Bz]}),t})();function S(t){return new C.w(t,"./assets/i18n/",".json")}let X=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[o.Pc,g.ez,h.u5,K,_.aw.forChild({loader:{provide:_.Zw,useFactory:S,deps:[A.eN]}})]}),t})()}}]);